select(y) %>%
filter(id == 5)
ts %>%
autoplot()
shift_level_max(ts$y)
shift_level_max(ts$y)
shift_kl_max(ts$y)
ts
ts %>%
autoplot(y)
ts <- daily_train %>%
select(y) %>%
filter(id == 8)
ts %>%
autoplot(y)
shift_level_max(ts$y)
shift_level_max(ts$y)
shift_kl_max(ts$y)
shift_level_max(ts$y)
shift_var_max(ts$y)
shift_kl_max(ts$y)
ts %>%
autoplot(y) +
geom_vline(xintercept = 612)
ts %>%
autoplot(y) +
geom_vline(xintercept = 612, linetype="dotted",
color = "blue", size=1.5)
ts
ggplot(ts, mapping=aes(y=y)) +
geom_line()
ts[[612]]
ts[[612], ]
ts[612, ]
ts[[612, ]]
ts[612, 0]
ts[612]$y
ts[612]
ts[612, ]
ts[612, ]$y
ts[612, ]
ts[612, 1]
ts %>%
autoplot(y) +
geom_vline(xintercept = ts[612, 1], linetype="dotted",
color = "blue", size=1.5)
ggplot(ts, mapping=aes(x=ds, y=y)) +
geom_line()
ggplot(ts, mapping=aes(x=ds, y=y)) +
geom_line() +
geom_vline(xintercept = ts[612, 1], linetype="dotted",
color = "blue", size=1.5)
ggplot(ts, mapping=aes(x=ds, y=y)) +
geom_line() +
geom_vline(
xintercept = ts[612, 1],
linetype="dotted",
color = "blue",
)
ts[612, 1]
ts[[612, 1]]
ggplot(ts, mapping=aes(x=ds, y=y)) +
geom_line() +
geom_vline(
xintercept = ts[[612, 1]],
linetype="dotted",
color = "blue",
)
ggplot(ts, mapping=aes(x=ds, y=y)) +
geom_line() +
geom_vline(
xintercept = as.numeric(ts[[612, 1]]),
linetype="dotted",
color = "blue",
)
ggplot(ts, mapping=aes(x=ds, y=y)) +
geom_line() +
geom_vline(
xintercept = as.numeric(ts[[612, 1]]),
linetype="dotted",
color = "blue",
size = 1.5
)
ggplot(ts, mapping=aes(x=ds, y=y)) +
geom_line() +
geom_vline(
xintercept = as.numeric(ts[[612, 1]]),
linetype="dotted",
color = "blue",
size = 10
)
ggplot(ts, mapping=aes(x=ds, y=y)) +
geom_line() +
geom_vline(
xintercept = as.numeric(ts[[612, 1]]),
color = "blue",
size = 10
)
ggplot(ts, mapping=aes(x=ds, y=y)) +
geom_line() +
geom_vline(
xintercept = as.numeric(ts[[612, 1]]),
color = "blue",
size = 10
)
ggplot(ts, mapping=aes(x=ds, y=y)) +
geom_line() +
geom_vline(
xintercept = as.numeric(ts[[612, 1]]),
color = "red",
size = 10
)
ggplot(ts, mapping=aes(x=ds, y=y)) +
geom_line() +
geom_vline(
xintercept = as.numeric(ts[[612, 1]]),
colour = "red",
linetype = 4
)
ts[[612, 1]]
ts[[612, 2]]
ggplot(ts, mapping=aes(x=ds, y=y)) +
geom_line() +
geom_vline(
xintercept = as.numeric(ts[[612, 2]]),
colour = "red",
linetype = 4
)
ts <- daily_train %>%
select(y) %>%
filter(id == 9)
ggplot(ts, mapping=aes(x=ds, y=y)) +
geom_line() +
geom_vline(
xintercept = as.numeric(ts[[612, 2]]),
colour = "red",
linetype = 4
)
shift_level_max(ts$y)
daily_train <- daily_train %>%
ts <- daily_train %>%
select(y) %>%
filter(id == 15)
daily_train <- daily_train %>%
ts <- daily_train %>%
select(y) %>%
filter(id == 15)
cp <- shift_level_max(ts$y)
daily_train <- daily_train %>%
ts <- daily_train %>%
select(y) %>%
filter(id == 15)
ts <- daily_train %>%
select(y) %>%
filter(id == 15)
cp <- shift_level_max(ts$y)
cp
cp$shift_level_index
cp[shift_level_index]
cp
cp[2]
cp["shift_level_index"]
cp[2]
ggplot(ts, mapping=aes(x=ds, y=y)) +
geom_line() +
geom_vline(
xintercept = cp[2],
colour = "red",
linetype = 4
)
ts[[cp[2], 2]
ts[[cp[2], 2]]
ts[[cp[2], 2]]
ts <- daily_train %>%
select(y) %>%
filter(id == 15)
ts_level_shift_info <- shift_level_max(ts$y)
level_shift_index = ts_level_shift_info[2]
level_shift_date = ts[[level_shift_index, 2]]
#shift_var_max(ts$y)
#shift_kl_max(ts$y)
ggplot(ts, mapping=aes(x=ds, y=y)) +
geom_line() +
geom_vline(
xintercept = level_shift_date,
colour = "red",
linetype = 4
)
ts <- daily_train %>%
select(y) %>%
filter(id == 16)
ts <- daily_train %>%
select(y) %>%
filter(id == 16)
ts_level_shift_info <- shift_level_max(ts$y)
level_shift_index = ts_level_shift_info[2]
level_shift_date = ts[[level_shift_index, 2]]
#shift_var_max(ts$y)
#shift_kl_max(ts$y)
ggplot(ts, mapping=aes(x=ds, y=y)) +
geom_line() +
geom_vline(
xintercept = level_shift_date,
colour = "red",
linetype = 4
)
ts <- daily_train %>%
select(y) %>%
filter(id == 19)
ts_level_shift_info <- shift_level_max(ts$y)
level_shift_index = ts_level_shift_info[2]
level_shift_date = ts[[level_shift_index, 2]]
#shift_var_max(ts$y)
ts_kl_shift_info <- shift_kl_max(ts$y)
kl_shift_index = ts_kl_shift_info[2]
kl_shift_date = ts[[kl_shift_index, 2]]
ggplot(ts, mapping=aes(x=ds, y=y)) +
geom_line() +
geom_vline(
xintercept = level_shift_date,
colour = "red",
linetype = 4
) +
geom_vline(
xintercept = kl_shift_date,
colour = "blue",
linetype = 4
)
ts_kl_shift_info
ts_level_shift_info
ts <- daily_train %>%
select(y) %>%
filter(id == 19)
ts_level_shift_info <- shift_level_max(ts$y)
level_shift_index = ts_level_shift_info[2]
level_shift_date = ts[[level_shift_index, 2]]
#shift_var_max(ts$y)
ts_kl_shift_info <- shift_kl_max(ts$y)
kl_shift_index = ts_kl_shift_info[2]
kl_shift_date = ts[[kl_shift_index, 2]]
print(ts_level_shift_info)
print(ts_kl_shift_info)
ggplot(ts, mapping=aes(x=ds, y=y)) +
geom_line() +
geom_vline(
xintercept = level_shift_date,
colour = "red",
linetype = 4
) +
geom_vline(
xintercept = kl_shift_date,
colour = "blue",
linetype = 4
)
ts <- daily_train %>%
select(y) %>%
filter(id == 5)
ts_level_shift_info <- shift_level_max(ts$y)
level_shift_index = ts_level_shift_info[2]
level_shift_date = ts[[level_shift_index, 2]]
#shift_var_max(ts$y)
ts_kl_shift_info <- shift_kl_max(ts$y)
kl_shift_index = ts_kl_shift_info[2]
kl_shift_date = ts[[kl_shift_index, 2]]
ggplot(ts, mapping=aes(x=ds, y=y)) +
geom_line() +
geom_vline(
xintercept = level_shift_date,
colour = "red",
linetype = 4
) +
geom_vline(
xintercept = kl_shift_date,
colour = "blue",
linetype = 4
)
print(ts_level_shift_info)
print(ts_kl_shift_info)
ts <- daily_train %>%
select(y) %>%
filter(id == 25)
ts_level_shift_info <- shift_level_max(ts$y)
level_shift_index = ts_level_shift_info[2]
level_shift_date = ts[[level_shift_index, 2]]
#shift_var_max(ts$y)
ts_kl_shift_info <- shift_kl_max(ts$y)
kl_shift_index = ts_kl_shift_info[2]
kl_shift_date = ts[[kl_shift_index, 2]]
ggplot(ts, mapping=aes(x=ds, y=y)) +
geom_line() +
geom_vline(
xintercept = level_shift_date,
colour = "red",
linetype = 4
) +
geom_vline(
xintercept = kl_shift_date,
colour = "blue",
linetype = 4
)
print(ts_level_shift_info)
print(ts_kl_shift_info)
ts <- daily_train %>%
select(y) %>%
filter(id == 25) %>%
autoplot(y)
ts %>%
autoplot()
ts <- daily_train %>%
select(y) %>%
filter(id == 25)
ts %>%
autoplot(y)
ts <- daily_train %>%
select(y) %>%
filter(id == 30)
ts %>%
autoplot(y)
ts <- daily_train %>%
select(y) %>%
filter(id == 30)
ts %>%
autoplot(y)
ts_level_shift_info <- shift_level_max(ts$y)
level_shift_index = ts_level_shift_info[2]
level_shift_date = ts[[level_shift_index, 2]]
#shift_var_max(ts$y)
ts_kl_shift_info <- shift_kl_max(ts$y)
kl_shift_index = ts_kl_shift_info[2]
kl_shift_date = ts[[kl_shift_index, 2]]
ggplot(ts, mapping=aes(x=ds, y=y)) +
geom_line() +
geom_vline(
xintercept = level_shift_date,
colour = "red",
linetype = 4
) +
geom_vline(
xintercept = kl_shift_date,
colour = "blue",
linetype = 4
)
print(ts_level_shift_info)
print(ts_kl_shift_info)
ts <- daily_train %>%
select(y) %>%
filter(id == 50)
ts %>%
autoplot(y)
ts <- daily_train %>%
select(y) %>%
filter(id == 50)
ts %>%
autoplot(y)
ts_level_shift_info <- shift_level_max(ts$y)
level_shift_index = ts_level_shift_info[2]
level_shift_date = ts[[level_shift_index, 2]]
#shift_var_max(ts$y)
ts_kl_shift_info <- shift_kl_max(ts$y)
kl_shift_index = ts_kl_shift_info[2]
kl_shift_date = ts[[kl_shift_index, 2]]
ggplot(ts, mapping=aes(x=ds, y=y)) +
geom_line() +
geom_vline(
xintercept = level_shift_date,
colour = "red",
linetype = 4
) +
geom_vline(
xintercept = kl_shift_date,
colour = "blue",
linetype = 4
)
print(ts_level_shift_info)
print(ts_kl_shift_info)
ts <- daily_train %>%
select(y) %>%
filter(id == 51)
ts %>%
autoplot(y)
ts_level_shift_info <- shift_level_max(ts$y)
level_shift_index = ts_level_shift_info[2]
level_shift_date = ts[[level_shift_index, 2]]
#shift_var_max(ts$y)
ts_kl_shift_info <- shift_kl_max(ts$y)
kl_shift_index = ts_kl_shift_info[2]
kl_shift_date = ts[[kl_shift_index, 2]]
ggplot(ts, mapping=aes(x=ds, y=y)) +
geom_line() +
geom_vline(
xintercept = level_shift_date,
colour = "red",
linetype = 4
) +
geom_vline(
xintercept = kl_shift_date,
colour = "blue",
linetype = 4
)
print(ts_level_shift_info)
print(ts_kl_shift_info)
library(tidyverse)
library(fpp3)
daily_train <- read_csv("./data/processed/daily-train-base.csv")
daily_train <- daily_train %>%
mutate(ds = as_date(ds)) %>%
as_tsibble(key=id, index=ds)
daily_train
install.package("progressr")
install.packages("progressr")
with_progress(
daily_train_features <- daily_train %>%
features(y, list(
feat_acf,
feat_pacf,
unitroot_ndiffs,
unitroot_nsdiffs,
var_tiled_mean,
var_tiled_var,
shift_level_max,
feat_stl,
feat_spectral,
n_crossing_points,
longest_flat_spot,
coef_hurst,
guerrero,
))
)
library(tidyverse)
library(fpp3)
library(progressr)
with_progress(
daily_train_features <- daily_train %>%
features(y, list(
feat_acf,
feat_pacf,
unitroot_ndiffs,
unitroot_nsdiffs,
var_tiled_mean,
var_tiled_var,
shift_level_max,
feat_stl,
feat_spectral,
n_crossing_points,
longest_flat_spot,
coef_hurst,
guerrero,
))
)
with_progress(
daily_train_features <- daily_train %>%
features(y, list(
feat_acf,
feat_pacf,
unitroot_ndiffs,
unitroot_nsdiffs,
var_tiled_mean,
var_tiled_var,
shift_level_max,
feat_stl,
feat_spectral,
n_crossing_points,
longest_flat_spot,
coef_hurst,
guerrero
))
)
progressr::handlers(global = TRUE)
daily_train_features <- daily_train %>%
features(y, list(
feat_acf,
feat_pacf,
unitroot_ndiffs,
unitroot_nsdiffs,
var_tiled_mean,
var_tiled_var,
shift_level_max,
feat_stl,
feat_spectral,
n_crossing_points,
longest_flat_spot,
coef_hurst,
guerrero
))
daily_train_features
library(tidyverse)
library(fpp3)
library(progressr)
# progressr::handlers(global = TRUE)
daily_train <- read_csv("./data/processed/daily-train-base.csv")
daily_train <- daily_train %>%
mutate(ds = as_date(ds)) %>%
as_tsibble(key=id, index=ds)
daily_train_features <- daily_train %>%
features(y, list(
feat_acf,
feat_pacf,
unitroot_ndiffs,
unitroot_nsdiffs,
var_tiled_mean,
var_tiled_var,
shift_level_max,
feat_stl,
feat_spectral,
n_crossing_points,
longest_flat_spot,
coef_hurst,
guerrero
))
write_csv(daily_train_features, "./data/processed/daily-train-features-r.csv")
daily_train_features
View(daily_train_features)
